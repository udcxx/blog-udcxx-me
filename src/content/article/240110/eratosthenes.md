---
title: エラトステネスの篩をJavaScriptで実装する
date: 2024-01-10
tags: IT
eyecatch: 240110.jpg
eyecatchEmoji: 🗽
description: エラトステネスの篩という素数を列挙するアルゴリズムをJavaScriptで実装してみました
---

こんにちは。だいちゃんです。

[shi3zさんのnote](https://note.com/shi3zblog/n/n896f8b0a2055) を読んでたら、最低限のプログラムの一例として**エラトステネスの篩（ふるい）**というアルゴリズムが登場していました。

調べてみると、プログラミングの題材としてもよく取り上げられる、指定した整数以下の素数を列挙するアルゴリズムらしかったので、力試しがてら、自分でも実装してみることにしました。

## エラトステネスの篩

[エラトステネスの篩（ふるい）](https://play.udcxx.me/24-eratosthenes/)

作成したのがこちら👆

適当な数字を入れて、開始をクリックするとアルゴリズムに従って素数以外をふるいにかけて、素数のみを列挙します。

普通に実装するだけだと、数秒で計算が終わってしまうところを、あえてインターバルを設けて少しずつ結果に近づく過程を見れるような仕組みにしたことが特徴です。

また、ビジュアル的にも、文字と図（？）を使って現時点でどういう判断となっているかを分かりやすくなるように工夫しました。

![](/images/240110.jpg)

ちなみに、JavaScriptで計算してるため、あまりにも大きな数値をいれるとブラウザに負荷がかかりすぎてしまうので、入力できる数値は100,000までに制限しています。それでも実行環境によってはフリーズしたり、動作が重くなってしまうかもしれません。ご注意あれ～


## アルゴリズム

ちゃんとした説明は[Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9)に譲るとして、簡単にアルゴリズムの概要だけ記載しておきます。

### Step.1 

任意の整数を入力します。この値を `x` とします。

開始ボタンがクリックされると、1からxまでの整数をずらっと並べておきます。このとき、すべての整数を `true（未判定）` （薄いオレンジ）とします。

### Step.2

ずらっと並べた整数を頭から順に見ていって、`true（未判定）`（薄いオレンジ）になっている整数にぶち当たったら、次の処理を行います。

【1の場合】   
1は素数ではないので `false（素数ではない）` にします。（グレーになります）

【2以上の場合】    
その整数を `prime（素数）` にします。（濃いオレンジになります）    
そして、その整数の2乗以上の倍数の値をすべて `false（素数ではない）` にします。（その整数は除く）

具体的には、次のような感じになります。

* 2の場合：2をprimeに。2の2乗は4なので、4以上の倍数（4, 6, 8, 10, 12, 14...）をfalseに。
* 3の場合：3をprimeに。3の2乗は9なので、9以上の倍数（9, 12, 15, 18, 21...）をfalseに。
* 4の場合：すでにfalseになってるのでスルー
* 5の場合：5をprimeに。5の2乗は25なので、25以上の倍数（25, 30, 35, 40...）をfalseに。
* 6の場合：すでにfalseになってるのでスルー

### Step.3

xの平方根に達するまで Step.2 を繰り返す

### Step.4

xの平方根に達した時点で `true（未判定）` になってる整数をすべて `prime（素数）` にします。

`prime（素数）` になっている整数がすべて素数です。

---

素数が出せたら[こんな問題](https://atcoder.jp/contests/abc084/tasks/abc084_d)を解くプログラムもかけるみたい。力試し的には良さそう。

**参考**

* [プログラミングの超基本的な考え方をド文系の人に説明した動画｜shi3z](https://note.com/shi3zblog/n/n896f8b0a2055)
* [エラトステネスの篩 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9)
* [エラトステネスの篩の活用法を総特集！ 〜 高速素因数分解・メビウスの反転公式 〜 #AtCoder - Qiita](https://qiita.com/drken/items/3beb679e54266f20ab63#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E4%BE%8B%E9%A1%8C)
* [D - 2017-like Number](https://atcoder.jp/contests/abc084/tasks/abc084_d)