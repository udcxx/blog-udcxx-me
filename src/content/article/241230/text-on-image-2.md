---
title: PHPã§ç¦å‰‡å‡¦ç†ã‚’å¼·å¼•ã«ã‚„ã‚‹
date: 2024-12-30
tags: Web IT
eyecatch: 
eyecatchEmoji: ğŸ–¼ï¸
description: PHPã‚’ä½¿ã£ã¦ã€å…ƒç”»åƒã«ä»»æ„ã®æ–‡å­—ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã€æ–°ãŸãªç”»åƒã‚’ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚ã®ç¶šãã€‚
---

ã“ã‚“ã«ã¡ã¯ã€‚ã ã„ã¡ã‚ƒã‚“ã§ã™ã€‚

[æ˜¨æ—¥](https://blog.udcxx.me/article/241229/text-on-image/) ã®ç¶šãã§ã™ã€‚

* [æ–‡å­—ã‚’åŸ‹ã‚è¾¼ã‚“ã ç”»åƒã‚’ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ä½œã£ãŸ](https://blog.udcxx.me/article/241229/text-on-image/)

é•·éãã‚‹æ–‡å­—ãŒã¯ã¿å‡ºã¡ã‚ƒã†å•é¡Œã‚’ä¿®æ­£ã—ã¦ã¿ã‚ˆã†ã€‚

## çµæœ

![](https://play.udcxx.me/24-text-on-image/images/E38193E3828CE381A7E3818AE3819DE38289E3818FE995B7E38184E995B7E38184E382BFE382A4E38388E383ABE3818CE585A5E381A3E381A6E3818DE381A6E38282E381A1E38283E38293E381A8E381AFE381BFE587BAE3819AE381ABE8A1A8E7A4BAE381A7E3818DE3828B.jpg)

[https://play.udcxx.me/24-text-on-image/?title=ã“ã‚Œã§ãŠãã‚‰ãé•·ã„é•·ã„ã‚¿ã‚¤ãƒˆãƒ«ãŒå…¥ã£ã¦ãã¦ã‚‚ã¡ã‚ƒã‚“ã¨ã¯ã¿å‡ºãšã«è¡¨ç¤ºã§ãã‚‹](https://play.udcxx.me/24-text-on-image/?title=%E3%81%93%E3%82%8C%E3%81%A7%E3%81%8A%E3%81%9D%E3%82%89%E3%81%8F%E9%95%B7%E3%81%84%E9%95%B7%E3%81%84%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%81%8C%E5%85%A5%E3%81%A3%E3%81%A6%E3%81%8D%E3%81%A6%E3%82%82%E3%81%A1%E3%82%83%E3%82%93%E3%81%A8%E3%81%AF%E3%81%BF%E5%87%BA%E3%81%9A%E3%81%AB%E8%A1%A8%E7%A4%BA%E3%81%A7%E3%81%8D%E3%82%8B)

## ã‚„ã£ãŸã“ã¨

æŒ‡å®šæ–‡å­—æ•°ã§æ”¹è¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

å…¨ä½“ãŒ60æ–‡å­—ä»¥å†…ãªã‚‰20æ–‡å­—ã”ã¨ã«ã€ãã‚Œä»¥ä¸Šãªã‚‰ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’20pxã«ã—ãŸã†ãˆã§35æ–‡å­—ã”ã¨ã«æ”¹è¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ã¤ã„ã§ã«ã€ç¦å‰‡å‡¦ç†ã‚’å…¥ã‚Œã¦ã€è‹±å˜èªã®é€”ä¸­ã¨ã‹ã€ã²ã‚‰ãŒãªãƒ»ã‚«ã‚¿ã‚«ãƒŠã®å°ã•ã„æ–‡å­—ï¼ˆã€Œã£ã€ã¨ã‹ï¼‰ã§æ”¹è¡Œã•ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```php
$fontsize = 36;
$breakpoint = 20;

if (mb_strwidth($title, 'UTF-8') > 120) {
    // å…¨ä½“ãŒ60æ–‡å­—ï¼ˆ= 20æ–‡å­— * 3è¡Œï¼‰ä»¥ä¸Šãªã‚‰ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´ + æ”¹è¡Œä½ç½®ã‚‚å¤‰æ›´
    $fontsize = 20;
    $breakpoint = 35;
}

if (mb_strwidth($title, 'UTF-8') > $breakpoint * 2) {
    $max_count = mb_strwidth($title, 'UTF-8') / $breakpoint * 2;

    // ç¦å‰‡å‡¦ç†ã«è©²å½“ã™ã‚‹æ–‡å­—
    $specialChars = [ 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'ãƒ¼', 'ã‚¡', 'ã‚£', 'ã‚¥', 'ã‚§', 'ã‚©', 'ãƒƒ', 'ãƒ£', 'ãƒ¥', 'ãƒ§', 'ãƒ®', 'ã€', 'ã€‚', 'ï¼ˆ', 'ï¼‰', 'ã€Œ', 'ã€', 'ã€', 'ã€‘', 'ã', 'ãƒ', 'ã…', 'ã‡', 'ã‰', 'ã£', 'ã‚ƒ', 'ã‚…', 'ã‚‡', 'ã‚'];

    $last_pos = 0;
    for ($count = 0; $count < $max_count; $count++) {
        for ($pos = $breakpoint + $last_pos; $pos > $last_pos; $pos--) {
            $char = mb_substr($title, $pos + 1, 1, 'UTF-8');

            if (!in_array($char, $specialChars)) {
                // ç¦å‰‡å‡¦ç†ã«è§¦ã‚Œãªã„ = æ”¹è¡ŒOK
                $title = mb_substr($title, 0, $pos + 1)."\n".mb_substr($title, $pos + 1);
                $last_pos = $pos - 1;
                break;

            } else if ($pos === $last_pos) {
                // ç¦å‰‡å‡¦ç†ã ã‚‰ã‘ãªã‚‰å¼·åˆ¶æ”¹è¡Œã—ã¡ã‚ƒãŠï¼
                $title = mb_substr($title, $last_pos, $last_pos + $breakpoint)."\n".mb_substr($title, $last_pos + 1);
                $last_pos = $pos;
                break;
            }
        }
    }
}

$angle = 0;
```

ã„ã‚ã„ã‚è©¦ã—ãŸã‚ã‘ã§ã¯ãªã„ã‘ã©ã€ã‚ã‚‹ç¨‹åº¦è€ãˆã‚‰ã‚Œãã†ãªã¨ã“ã‚ã¾ã§ãã¾ã—ãŸã€‚

ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ã¯ã€`mb_strwidth()` ã¯å…¨è§’æ–‡å­—ã‚’2ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã‘ã©ã€`mb_substr()` ã¯å…¨è§’æ–‡å­—ã‚‚1ã§ã‚«ã‚¦ãƒ³ãƒˆã—ã¡ã‚ƒã†ç‚¹ã§ã™ã‹ã­ã€‚`$breakpoint` ã‚’ã„ã„æ„Ÿã˜ã«ä½¿ã„ã¾ã‚ã—ãŸã‹ã£ãŸã®ã«...

`mb_strwidth()` ã¯æ–‡å­—ã® **å¹…** ã‚’è¿”ã—ã¦ã‚‹ã‹ã‚‰ä»•æ–¹ãªã„ã‚“ã ã‘ã©ã€‚

---

PHPè‹¦æ‰‹ã ã‘ã©ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã—ã£ã‹ã‚Šã—ã¦ã‚‹ã®ãŒã„ã„ã­ã€‚çµæ§‹åŠ©ã‘ã‚‰ã‚Œã¦ã‚‹ã€‚

* [PHP: mb_substr - Manual](https://www.php.net/manual/ja/function.mb-substr.php)
* [PHP: mb_strwidth - Manual](https://www.php.net/manual/ja/function.mb-strwidth.php)